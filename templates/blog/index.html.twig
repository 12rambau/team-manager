{% extends 'layout.html.twig' %}

{% block title %}Blog index
{% endblock %}

{% block page_title %}
	<h1>Blog Posts</h1>
{% endblock %}

{% block stylesheets %}
	{{ parent() }}

	{{ encore_entry_link_tags('blog') }}
{% endblock %}

{% block content %}
	<ul class="nav nav-pills justify-content-center">
		<li class="nav-item">
			<a class="nav-link" id="pills-list" data-toggle="pill" href="#post-list" aria-controls="post-list" aria-selected="false">
				<span class="fa fa-bars"/>
			</a>
		</li>
		<li class="nav-item">
			<a class="nav-link active" id="pills-th" data-toggle="pill" href="#post-th" aria-controls="post-th" aria-selected="true">
				<span class="fas fa-th"/>
			</a>
		</li>
	</ul>

	<hr>

	<div class="tab-content">

		<div id="post-list" class="tab-pane fade" aria-labelledby="pills-list">
			{% for post in posts %}
				<div class="news mb-2">
					<div class="card shadow">
						<div class="row">
							<div class="col-4">
								<img src="{{ asset('image/default/no-image-news.jpg')|imagine_filter('news') }}" class="w-100 h-100">
							</div>
							<div class="card-block">
								<div class="card-title">
									<h4>{{ post.title }}</h4>
								</div>
								<div class="card-text">
									<strong class="text-primary">
										By
										{{ post.author.firstName }}
										{{ post.author.lastName }}
									</strong>
									<span class="text-muted ml-1">
										on
										{{ post.publishDate|date('d/m/Y') }}
										<a class="chevron-display ml-1 text-danger" href="#" onclick="displayDetails(event)">
											<span id="{{ post.slug }}-button" class="fa fa-chevron-down"/>
										</a>
									</span>
								</div>
							</div>
						</div>
					</div>
					<div id="{{ post.slug }}-details" class="container detail col-12 clearfix">
						<div class="mr-2 card-text">
							{{ post.short|slice(0,150)|raw}}
						</div>
						<div class="float-right">
							<a href="{{ path('blog-view', { 'slug':post.slug }) }}" class="btn btn-primary">Learn more</a>
						</div>
					</div>
				</div>
			{% else %}
				<div class="card">
					<div class="card-body">
						<h2 class="card-title">no Post to display (yet!)</h2>
					</div>
				</div>
			{% endfor %}
		</div>

		<div id="post-th" class="tab-pane fade show active" aria-labelledby="pills-th">
			<div class="row">
				{% for post in posts %}
					<div class=" col-4 p-2">
						<div class="card shadow h-100">
							<img class="card-img-top" src="{{ asset('image/default/no-image-news.jpg')|imagine_filter('news') }}">
							<div class="card-body position-relative">
								<figure class="profile">
									<img src="{{ asset(vich_uploader_asset(post.author.profilePic, "imageFile")|imagine_filter('userNavbar')) }}" class="profile-avatar" alt="">
								</figure>
								<h5 class="card-title mt-3">{{ post.title }}</h5>
								<div class="text-primary mb-1">
									<small>by
										<b>{{ post.author.username }}</b>
									</small>
								</div>
								<div class="card-text">
									On {{ post.short|slice(0,150)|raw}}
								</div>
							</div>
							<div class="card-footer clearfix">
								<small>{{ post.publishDate|date('d/m/Y') }}</small>
								<div class="btn-group float-right">
									<button class="btn btn-secondary float-right btn-sm">learn more</button>
								</div>

							</div>
						</div>
					</div>
				{% else %}
					<div class="card">
						<div class="card-body">
							<h2 class="card-title">no Post (yet!)</h2>
						</div>
					</div>
				{% endfor %}
			</div>
		</div>

	</div>


	<hr/>

	<div class=" row">
		<nav class="col-lg-6">
			<ul class="pagination">
				<li class="page-item {% if page == 1 %}disabled{% endif %}">
					<a class="page-link" href="{{ path('blog-index', {'page': page-1}) }}">Previous</a>
				</li>
				{% for i in max(page-3,1)..min(page+3,maxPage) %}
					<li class="page-item {% if i == page %}active{% endif %}">
						<a class="page-link" href="{{ path('blog-index', {'page': i}) }}">{{ i }}</a>
					</li>
				{% endfor %}
				<li class="page-item {% if page == maxPage %}disabled{% endif %}">
					<a class="page-link" href="{{ path('blog-index', {'page': page+1}) }}">Next</a>
				</li>
			</lu>
		</nav>
		<div class="col-lg-6">Result
			{{ (page-1) * nbPostPerPage }}
			-
			{{ min(page * nbPostPerPage,nbPost) }}
			from
			{{ nbPost }}
			blogPost</div>
	</div>
{% endblock %}
{% block javascripts %}
	{{ parent() }}

	{{ encore_entry_script_tags('blog') }}
{% endblock %}
